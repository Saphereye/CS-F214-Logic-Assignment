<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Logic Assignment: Profiling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="basic.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Logic Assignment
   </div>
   <div id="projectbrief">Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_Profiling.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Profiling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md4"></a>
Goal</h1>
<p>The goal is to</p><ul>
<li>Find spots in our program which are slow, and thus helping us identify the real weak points</li>
<li>Identify memory leaks, in order to stop building up of junk memory </li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Tools</h1>
<p>For runtime of each function we used <code>chrono</code> library of C++ on the given system. This library provide high accuracy data, which was useful to record information with even small inputs.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">OS Name </th><th class="markdownTableHeadLeft">System Type </th><th class="markdownTableHeadLeft">Processor </th><th class="markdownTableHeadLeft">Usable Ram  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Windows 10 </td><td class="markdownTableBodyLeft">x64-based </td><td class="markdownTableBodyLeft">11th Gen Intel(R) Core(TM) i3-1115G4 @ 3.00GHz, 2995 Mhz, 2 Core(s), 4 Logical Processor(s) </td><td class="markdownTableBodyLeft">7.65 GB  </td></tr>
</table>
<p>For memory analysis of the program we used inbuilt memory analysis of Visual Studio on the given system. We chose this due to it's high accuracy and descriptive output, which helped us understand the code better.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">OS Name </th><th class="markdownTableHeadLeft">System Type </th><th class="markdownTableHeadLeft">Processor </th><th class="markdownTableHeadLeft">Usable Ram  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Windows 11 </td><td class="markdownTableBodyLeft">x64-based </td><td class="markdownTableBodyLeft">Intel(R) Core(TM) i5-10300H CPU @ 2.50 GHz, 2496 Mhz, 4 Core(S), 8 Logical Processor(s) </td><td class="markdownTableBodyLeft">3.10 GB  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md6"></a>
Input</h1>
<p>A randomised input was generated each time using the given python script</p>
<div class="fragment"><div class="line">import random</div>
<div class="line">from tokenize import String</div>
<div class="line"> </div>
<div class="line">&quot;&quot;&quot;</div>
<div class="line">BNF for our expression</div>
<div class="line">E := I | (E + E) | (E * E) | (E &gt; E) | (~ E)</div>
<div class="line">&quot;&quot;&quot;</div>
<div class="line">heightOfParseTree: int = 15</div>
<div class="line"> </div>
<div class="line">def randInfix(count: int) -&gt; String:</div>
<div class="line">    if count &lt;= 1:</div>
<div class="line">        return random.choice(list(&quot;abcdefghijklmnopqrstuvwxyz&quot;))[0]</div>
<div class="line">    else:</div>
<div class="line">        case = random.randint(1, 4)</div>
<div class="line">        if case == 1:</div>
<div class="line">                return f&quot;({randInfix(count-1)}*{randInfix(count-1)})&quot;</div>
<div class="line">        elif case == 2:</div>
<div class="line">                return f&quot;({randInfix(count-1)}+{randInfix(count-1)})&quot;</div>
<div class="line">        elif case == 3:</div>
<div class="line">                return f&quot;({randInfix(count-1)}&gt;{randInfix(count-1)})&quot;</div>
<div class="line">        elif case == 4:</div>
<div class="line">                return f&quot;(~{randInfix(count-1)})&quot;</div>
<div class="line"> </div>
<div class="line">infix = randInfix(heightOfParseTree)</div>
<div class="line"> </div>
<div class="line">with open(&quot;InfixText.txt&quot;,&quot;w&quot;) as file:</div>
<div class="line">    file.write(infix)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Execution</h1>
<p>The program was optimised with flags <code>-Os -O2</code>.</p>
<p>The <code>-Os</code> flag optimizes the size of the code. Whereas <code>-O2</code> optimizes for speed. Size optimization happens at the cost of speed. For example replacing with body of code instead of a call function.</p>
<p>For time analysis, each task was run <code>1000</code> times and the average was considered. The following data was reveived</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Tree Height </th><th class="markdownTableHeadLeft">No. of Atoms </th><th class="markdownTableHeadLeft">Task 1 (ms) </th><th class="markdownTableHeadLeft">Task 2 (ms) </th><th class="markdownTableHeadLeft">Task 3 (ms) </th><th class="markdownTableHeadLeft">Task 4 (ms) </th><th class="markdownTableHeadLeft">Task 5 (ms)  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">5 </td><td class="markdownTableBodyLeft">10 </td><td class="markdownTableBodyLeft">0.0047605 </td><td class="markdownTableBodyLeft">0.0079753 </td><td class="markdownTableBodyLeft">0.005358 </td><td class="markdownTableBodyLeft">0.008284 </td><td class="markdownTableBodyLeft">0.0054994  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">5 </td><td class="markdownTableBodyLeft">12 </td><td class="markdownTableBodyLeft">0.0028622 </td><td class="markdownTableBodyLeft">0.0055984 </td><td class="markdownTableBodyLeft">0.009877 </td><td class="markdownTableBodyLeft">0.0060635 </td><td class="markdownTableBodyLeft">0.0086048  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">10 </td><td class="markdownTableBodyLeft">119 </td><td class="markdownTableBodyLeft">0.0347532 </td><td class="markdownTableBodyLeft">0.0581992 </td><td class="markdownTableBodyLeft">0.0647751 </td><td class="markdownTableBodyLeft">0.0625164 </td><td class="markdownTableBodyLeft">0.0591974  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">10 </td><td class="markdownTableBodyLeft">191 </td><td class="markdownTableBodyLeft">0.0478533 </td><td class="markdownTableBodyLeft">0.0898297 </td><td class="markdownTableBodyLeft">0.0969904 </td><td class="markdownTableBodyLeft">0.090525 </td><td class="markdownTableBodyLeft">0.0993498  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">15 </td><td class="markdownTableBodyLeft">2425 </td><td class="markdownTableBodyLeft">0.189015 </td><td class="markdownTableBodyLeft">0.549159 </td><td class="markdownTableBodyLeft">0.615554 </td><td class="markdownTableBodyLeft">0.625281 </td><td class="markdownTableBodyLeft">0.609831  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">15 </td><td class="markdownTableBodyLeft">3425 </td><td class="markdownTableBodyLeft">0.488783 </td><td class="markdownTableBodyLeft">0.9894795 </td><td class="markdownTableBodyLeft">1.60096 </td><td class="markdownTableBodyLeft">1.51223 </td><td class="markdownTableBodyLeft">1.44321  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">17 </td><td class="markdownTableBodyLeft">4554 </td><td class="markdownTableBodyLeft">0.545341 </td><td class="markdownTableBodyLeft">1.4298 </td><td class="markdownTableBodyLeft">1.62267 </td><td class="markdownTableBodyLeft">1.4522 </td><td class="markdownTableBodyLeft">1.54193  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">17 </td><td class="markdownTableBodyLeft">8894 </td><td class="markdownTableBodyLeft">0.500103 </td><td class="markdownTableBodyLeft">1.51216 </td><td class="markdownTableBodyLeft">1.62874 </td><td class="markdownTableBodyLeft">1.55287 </td><td class="markdownTableBodyLeft">1.555075  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">18 </td><td class="markdownTableBodyLeft">11137 </td><td class="markdownTableBodyLeft">0.528771 </td><td class="markdownTableBodyLeft">1.99178 </td><td class="markdownTableBodyLeft">1.67444 </td><td class="markdownTableBodyLeft">1.53555 </td><td class="markdownTableBodyLeft">1.6110075  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">20 </td><td class="markdownTableBodyLeft">46394 </td><td class="markdownTableBodyLeft">0.686642 </td><td class="markdownTableBodyLeft">1.47442 </td><td class="markdownTableBodyLeft">1.70191 </td><td class="markdownTableBodyLeft">1.61959 </td><td class="markdownTableBodyLeft">1.66694  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">20 </td><td class="markdownTableBodyLeft">65619 </td><td class="markdownTableBodyLeft">0.513933 </td><td class="markdownTableBodyLeft">1.45734 </td><td class="markdownTableBodyLeft">1.73145 </td><td class="markdownTableBodyLeft">1.55454 </td><td class="markdownTableBodyLeft">1.50251  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md8"></a>
Data in Graphical Manner</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Number of atoms Vs time taken graph</h2>
<div class="image">
<img src="task_vs_time.jpeg" alt=""/>
<div class="caption">
Number of atoms Vs time taken</div></div>
   <h2><a class="anchor" id="autotoc_md10"></a>
Task Dependency Graph</h2>
<p><a href="https://mermaid.live/edit#pako:eNp1kV1LwzAUhv9KONdtaLY0WXMh7AsUFETFC1svwnq2FtdmZClslv1303YVBc3VOed93jdfLWxMjqBgZ_WhIPdPWU38mqeMkrt6W56IM-TRoq_eB2mRTuh10mvaHpG8WESvXwkShjdkPrbLdEp_YJ2pT_7mlz2_GNtVyim5xXJXOGK2f22w-m1YpzH1QOMK8qr3Df7jWo8uCKBCW-ky9_duOzEDV2CFGShf5tp-ZJDVF881h1w7XOelMxaUsw0GoBtnns_1ZuwHZlVq_4QVqK3eH_30oGtQLZxAhbMZFUkUSy54nCSCBXAGxSMaC84ZT-Qsmsgp55cAPo3xCYwyKeVUCBnHzBs7h49768VrPPZHehj-rv_CyxdUX4ig"><img src="https://mermaid.ink/img/pako:eNp1kV1LwzAUhv9KONdtaLY0WXMh7AsUFETFC1svwnq2FtdmZClslv1303YVBc3VOed93jdfLWxMjqBgZ_WhIPdPWU38mqeMkrt6W56IM-TRoq_eB2mRTuh10mvaHpG8WESvXwkShjdkPrbLdEp_YJ2pT_7mlz2_GNtVyim5xXJXOGK2f22w-m1YpzH1QOMK8qr3Df7jWo8uCKBCW-ky9_duOzEDV2CFGShf5tp-ZJDVF881h1w7XOelMxaUsw0GoBtnns_1ZuwHZlVq_4QVqK3eH_30oGtQLZxAhbMZFUkUSy54nCSCBXAGxSMaC84ZT-Qsmsgp55cAPo3xCYwyKeVUCBnHzBs7h49768VrPPZHehj-rv_CyxdUX4ig?type=png" alt="" class="inline"/></a></p>
<p>This graph shows the dependency of each function. For example Prefix to parse tree requires the input infix to be converted top prefix first, hence it requires the function of the first task. </p>
<h2><a class="anchor" id="autotoc_md11"></a>
Memory Usage (1343 atoms, Height 12)</h2>
<div class="image">
<img src="memory_profile_1343.jpeg" alt=""/>
<div class="caption">
Memory Usage Table</div></div>
   <p>Each blue down arrow (▼) and the ID are the snapshots of the memory before the respective task. </p>
<h2><a class="anchor" id="autotoc_md12"></a>
Call comparison between 1343 and 360 atoms</h2>
<div class="image">
<img src="call_comparison.jpeg" alt=""/>
<div class="caption">
Call comparison between 1343 and 360 atoms</div></div>
   <p>This is a comparison between memory taken by a program with input of 1343 and 360 atoms repectively. </p>
<h1><a class="anchor" id="autotoc_md13"></a>
Analysis</h1>
<h2><a class="anchor" id="autotoc_md14"></a>
Time Analysis</h2>
<p>Until <code>4554</code> atoms, the time taken rises sharply. This is followed by decrease in the rate of change and it levels down to a linear relation with constant increase in time taken as number of atoms increase.</p>
<p>We can explain this linear increase with time complexity. As the algorithms traverse throughg each element/node, one can approximate them to be <code>O(n)</code>.</p>
<p>Furthermore, from the task dependency graph we can see that task 1 must have the least time, followed by task 2, followed by 3, 4 and 5.</p>
<p>One can observe sharp variations in data, which we consider as experimental error. </p>
<h2><a class="anchor" id="autotoc_md15"></a>
Memory Analysis</h2>
<p>In the above image "Memory Usage", one can see a sudden increase heap memory between ID 3 and 4 which corresponds to allocation of heap memory for the pointers of the binary parse tree.</p>
<p>As the program <code>main.exe</code> evaluates each component from scratch (as show in 'Task Dependency Graph'), it leads to multiple allocation of heap memory, which hasn't been freed.</p>
<p>Thus memory analysis helped us in uncovering memory leaks in our program. </p>
<h1><a class="anchor" id="autotoc_md16"></a>
Conclusion</h1>
<p>This exercise helped us see how our functions are behaving under stress. This helped us find the bottlenecks in out code and find out that naïve methods lead to memory leaks. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
